function handleErrors(a){if(!a.ok)throw Error(a.statusText);return a}function Channelfetcher(a){if(!a)var a={}}Channelfetcher.prototype.fetchChannels=function(a,b){var c=this,d=a,f={basic:[],latino:[],addon:[],areaName:""};fetch("https://api.fubo.tv/v3/plan-manager/plans").then(handleErrors).then(function(a){return a.json()}).then(function(a){if(responseData=a.data,responseData&&0<responseData.length){f.basic=responseData[0].default_package.channels;var b=responseData[0].add_on_packages?responseData[0].add_on_packages:"";if(1<responseData.length&&responseData[1].default_package&&"latino-basic"===responseData[1].slug){f.latino=responseData[1].default_package.channels;var b=responseData[0].add_on_packages?responseData[0].add_on_packages:""}if(b&&0<b.length){for(var d=f.basic.concat(f.latino),g=[],h=0;h<d.length;h++)d[h].meta&&d[h].meta.callSign&&g.push(d[h].meta.callSign);for(var i=[],j=0;j<b.length;j++)if(b[j].channels&&0<b[j].channels.length)for(var k,l=0;l<b[j].channels.length;l++)k={},k.meta={},k.meta.callSign=b[j].channels[l].meta.callSign,-1===g.indexOf(k.meta.callSign)&&(g.push(k.meta.callSign),k.meta.networkLogoOnWhiteUrl=b[j].channels[l].meta.networkLogoOnWhiteUrl,k.meta.networkLogoOnDarkUrl=b[j].channels[l].meta.networkLogoOnDarkUrl,k.meta.displayName=b[j].channels[l].meta.displayName,k.meta.networkName=b[j].channels[l].meta.displayName,k.meta.category="premium",k.pktype="pkg_addon",i.push(k));else if("amc-premiere"===b[j].slug){var k={};k.meta={},k.meta.callSign="",k.meta.networkLogoOnWhiteUrl=b[j].images.logo_on_white_url,k.meta.networkLogoOnDarkUrl=b[j].images.logo_on_dark_url,k.meta.displayName=b[j].name,k.meta.networkName=b[j].name,k.meta.category="premium",k.pktype="pkg_addon",i.push(k)}f.addon=i}console.log(f)}else throw Error("No channels available.")}).then(function(){fetch("https://api.fubo.tv/v3/location").then(handleErrors).then(function(a){return a.json()}).then(function(a){a.display_name&&0<a.display_name.length&&"USA"!==a.display_name&&(f.areaName=a.display_name),d(f,b)}).catch(function(a){console.log(a)})}).catch(function(a){console.log(a),fetch("https://www.fubo.tv/lp/v3_files/sharedlibraries/channelfetcher/default.json").then(handleErrors).then(function(a){return a.json()}).then(function(a){f.basic=a,console.log("default basic channels data")}).then(function(){fetch("https://www.fubo.tv/lp/v3_files/sharedlibraries/channelfetcher/default_latino.json").then(handleErrors).then(function(a){return a.json()}).then(function(a){console.log("default latino channels data"),f.latino=a}).then(function(){fetch("https://api.fubo.tv/v3/location").then(handleErrors).then(function(a){return a.json()}).then(function(a){a.display_name&&0<a.display_name.length&&(f.areaName=a.display_name)}).catch(function(a){console.log(a)})}).then(function(){d(f,b)})}).catch(function(a){console.log(a)})})},Channelfetcher.prototype.loadChannelbuilder=function(a,b){b=b?b:{},window._ftv.channelbuilder=new Channelbuilder({channels:a,css:b.css?b.css:"",sort:b.sort?b.sort:"",logoStyle:b.logoStyle?b.logoStyle:"",showPremium:b.showPremium?b.showPremium:"",showAllPremium:b.showAllPremium?b.showAllPremium:"",showLatino:b.showLatino?b.showLatino:""}),window._ftv.channelbuilder.init()};function Channelbuilder(a){if(!a)var a={};this.channels=function(b){return a.channels&&b?a.channels[b]:(console.error("No channels included in Channelbuilder options"),[])},this.channelsCount=function(b){return a.channels&&"latino"===b?a.channels[b].length:a.channels&&"basic"===b?a.channels[b].length+a.channels.addon.length:"100+"},this.areaName=function(){return a.channels&&a.channels.areaName?"the "+a.channels.areaName:"Your"},this.showLatino=function(){return!!(a&&a.showLatino)},a&&!a.targets&&(a.targets={parentDiv:"#fuboChannelsTarget",channelCount:"#channelfetcherCount",channelAreaName:"#channelfetcherAreaName"}),this.targets=function(){return a.targets},a&&!a.css&&(a.css="https://www.fubo.tv/lp/v3_files/sharedlibraries/channelfetcher/styles.css"),this.css=function(){return a.css},a&&!a.logoStyle&&(a.logoStyle="color"),this.logoStyle=function(){return a.logoStyle},this.sortFunction=function(){var b=!1;if(a&&a.sort)switch(a.sort.type){case"picklistTitle":b=function(a,b){return a.sort(function(c){let a=!1;for(let d=0;d<b.length;d++)c.meta.displayName.toLowerCase()===b[d].toLowerCase()&&(c.order=d,a=!0);return a?-1:1}),a.sort(function(c,a){return c.order-a.order}),a};break;case"genreFirst":b=function(){};}return b},this.picklist=function(){return a&&a.sort&&a.sort.picklist?a.sort.picklist:[]},this.showPremium=function(){return!!(a&&a.showPremium)&&a.showPremium},this.showAllPremium=function(){return!!(a&&a.showAllPremium)},this.createTarget=function(a){var b,c={element:"",className:"",idName:""};return"parentDiv"===a?(c.element="div",c.idName="fuboChannelsTarget",b=function(a){var b;return b=document.createElement(a.element),b.className+=a.className,b.id=a.idName,b}(c)):void 0,b},this.loadFile=function(a,b){if("js"==b){var c=document.createElement("script");c.setAttribute("type","text/javascript"),c.setAttribute("src",a)}else if("css"==b){var c=document.createElement("link");c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",a)}"undefined"!=typeof c&&document.getElementsByTagName("head")[0].appendChild(c)}}Channelbuilder.prototype.findOrCreateTargets=function(){var a=this.targets(),b={parentDiv:"",channelCount:"",channelAreaName:""};for(target in a)b[target]=0==document.querySelectorAll(a[target]).length?this.createTarget(target,a[target]):document.querySelectorAll(a[target])[0];return b},Channelbuilder.prototype.init=function(a){function b(a){if(!a)return f;var b=f;return b=a(b,g.picklist()),b}function c(a,b){var c=document.createElement("div");if(a.meta.category)var d="category_"+a.meta.category.toLowerCase();else var d="category_other";c.classList.add("channelContain",d,b);var e=document.createElement("img");return e.src="white"===m?a.meta.networkLogoOnDarkUrl+"?w=100&h=63&fit=fill&fill=solid&auto=format%2Ccompress":a.meta.networkLogoOnWhiteUrl+"?w=100&h=63&fit=fill&fill=solid&auto=format%2Ccompress",e.setAttribute("srcset",e.src+"1x, "+e.src+"&dpr=2 2x, "+e.src+"&dpr=3 3x"),e.setAttribute("srccolor",a.meta.networkLogoOnWhiteUrl),e.setAttribute("srcwhite",a.meta.networkLogoOnDarkUrl),e.setAttribute("alt",a.meta.displayName),e.setAttribute("title",a.meta.networkName),e.setAttribute("search_title",a.meta.displayName.toLowerCase()),e.setAttribute("pktype",b),e.classList.add("channelLogo"),e.setAttribute("category",a.meta.category),c.appendChild(e),c}var a=a?"expand":"firstrun";window._ftv.channelbuilder.loadFile(this.css(),"css");var d=window._ftv.channelbuilder.findOrCreateTargets(),e=this.showLatino();if(e)var f=this.channels("latino");else var f=this.channels("basic");var g=this;if("firstrun"===a){var h=this.sortFunction();if(h){var j=b(h)}else{var j=f}if(j&&33<j.length){document.getElementById("moreChannels").addEventListener("touchend",function(a){a.preventDefault(),a.target.click()},!1),document.getElementById("moreChannels").addEventListener("keypress",function(a){("keypress"===a.type&&13===a.keyCode||32===a.keyCode)&&(a.preventDefault(),a.target.click())});var g=this;document.getElementById("moreChannels").addEventListener("click",function(){g.init("expand")},!1);var j=f.slice(0,33)}else d.parentDiv.classList.add("expanded");var k=e?this.channelsCount("latino"):this.channelsCount("basic");k&&d.channelCount&&(d.channelCount.innerHTML=k),d.channelAreaName&&(d.channelAreaName.innerHTML=this.areaName());var m=this.logoStyle()}else{var j=f.slice(33),m=this.logoStyle();d.parentDiv.classList.add("expanded")}if(j&&0<j.length)for(var o=0,q=j.length;o<q;o++){var l=j[o],r=c(l,"pkg_basic");d.parentDiv.appendChild(r)}var s=this.channels("addon");if("firstrun"===a&&this.showPremium()){for(var t=this.showPremium(),u=[],o=0;o<t.length;o++)for(var v=0;v<s.length;v++)if(t[o].toLowerCase()===s[v].meta.displayName.toLowerCase()){var w={};w.meta=s[v].meta,w.meta.category="premium",w.pktype="pkg_addon",u.push(w)}if(u&&0<u.length)for(var x=d.parentDiv.childNodes[19],y=0;y<u.length;y++){let a=u[y],b=c(a,"pkg_premium");if(x){(function(a,b){b.parentNode.insertBefore(a,b)})(b,x)}else d.parentDiv.appendChild(b)}}if("firstrun"!==a&&s&&0<s.length&&this.showAllPremium())for(var y=0;y<s.length;y++){let a=s[y],b=c(a,"pkg_premium");d.parentDiv.appendChild(b)}};